{% extends "base.html" %}
{% load humanize %}

{# Load the tag library #}
{% load bootstrap3 %}

{% load static %}

{# Load CSS and JavaScript #}
{% bootstrap_css %}
{% bootstrap_javascript %}

{# Display django.contrib.messages as Bootstrap alerts #}
{% bootstrap_messages %}

{% block extracss %}
<style type="text/css">
    #titulo {
        font-family: Arial;
        font-size: 29px;
        color: #B5B6B8;
    }
    h3 {
        font-family: Arial;
        color: #C6C6C6;
        font-size: 20;
    }
    .panel {
        border-color: #C6C6C6;
        border-radius: 2px;
    }
    .panel-body {
      line-height: 30px;
    }
    .panel-heading {
        height: 40px;
        font-size: 20px;
        line-height: 20px !important;
    }
    #subtitulo {
        font-family: Arial;
        font-size: 15px;
        color: #828489;
    }
    .text-right {
        text-align: left;
        line-height: 30px;
    }
    .select {
        color: #FFFFFF; 
        background-color: #727270;
        text-align: center;
        float: right;
    }
    .back {
        color: #FFFFFF; 
        background-color: #E76C42;
        width: 20%;
        height: 40px;
        text-align: center;
        float: left;
    }

</style>
{% endblock extracss %}


{% block content %}
<div class="row">
    <div class="col-md-2" style="padding-top: 10%"></div>
    <div class="col-md-8 text-center" style="padding-top: 10%">
        <h1 id="titulo" class="text-center"><strong>COTIZACIÓN DE PÓLIZA DE SEGUROS PARA AUTOMÓVIL</strong></h1>
        <h3 id="subtitulo" class="text-center">3 simples pasos para cotizar en línea la póliza</h3>
        <img src="{% static 'img/1-2-3_cotizador_acerta_3.png' %}">
    </div>
    <div class="col-md-2" style="padding-top: 10%"></div>
</div>
<div class="row" style="padding-top: 5%">
    <div class="col-xs-12">
        <div class="row">
            <div class="col-xs-10 col-sm-10 col-md-2"></div>
            <div class="col-xs-12 col-sm-12 col-md-8 panel panel-default" style="border-width: 4px; border-color: 8CA5F0; border-top-color: #E76C42;">
                <div class="panel-body">
                    <div style="margin: 1% auto;">
                        <div class="login-logo">
                        </div><!-- /.login-logo -->
                        <div class="login-box-body">
                            <table style="width:100%">
                              <tr>
                                <th>Descp. de Cobertura</th>
                                <th>Suma Asegurada<br>Por persona/Por accidente</th>
                                <th>Deducible</th>
                                <th>Prima</th>
                              </tr>
                              <tr>
                                <td>Lesiones Corporales</td>
                                <td>{{ cotizacion.lesiones_corporales }}</td>
                                <td></td>
                                <td>{{ cotizacion.prima_lesiones|floatformat:2|intcomma }}</td>
                              </tr>
                              <tr>
                                <td>Daños a la Propiedad Ajena</td>
                                <td>{{ cotizacion.danios_propiedad }}</td>
                                <td></td>
                                <td>{{ cotizacion.prima_daniosProp|floatformat:2|intcomma }}</td>
                              </tr>
                              <tr>
                                <td>Gastos Médicos por Accidente</td>
                                <td>{{ cotizacion.gastos_medicos }}</td>
                                <td></td>
                                <td>{{ cotizacion.prima_gastosMedicos|floatformat:2|intcomma }}</td>
                              </tr>
                              <tr>
                                <td>Otros Daños</td>
                                <td>{{ cotizacion.conductor.valor|floatformat:2|intcomma }}</td>
                                <td>{{ cotizacion.otros_danios|floatformat:2|intcomma }}</td>
                                <td>{{ cotizacion.prima_otrosDanios|floatformat:2|intcomma }}</td>
                              </tr>
                              <tr>
                                <td>Colisión y Vuelco</td>
                                <td>{{ cotizacion.conductor.valor|floatformat:2|intcomma }}</td>
                                <td>{{ cotizacion.colision_vuelco|floatformat:2|intcomma }}</td>
                                <td>{{ cotizacion.prima_colisionVuelco|floatformat:2|intcomma }}</td>
                              </tr>
                              <tr>
                                <td>Incendio y Rayo</td>
                                <td>{{ cotizacion.conductor.valor|floatformat:2|intcomma }}</td>
                                <td>{{ cotizacion.incendio_rayo|floatformat:2|intcomma }}</td>
                                <td>-</td>
                              </tr>
                              <tr>
                                <td>Robo y Hurto</td>
                                <td>{{ cotizacion.conductor.valor|floatformat:2|intcomma }}</td>
                                <td>{{ cotizacion.robo_hurto|floatformat:2|intcomma }}</td>
                                <td>-</td>
                              </tr>
                              <tr>
                                <td>Muerte Accidental</td>
                                <td>{{ cotizacion.muerte_accidental }}</td>
                                <td></td>
                                <td>-</td>
                              </tr>
                              <tr>
                                <td>Asistencia Legal</td>
                                <td>Incluido</td>
                                <td></td>
                                <td>-</td>
                              </tr>
                              <tr>
                                <td>Importación de Piezas</td>
                                {% if cotizacion.importacion_piezas%}
                                  <td>Incluido</td>
                                  <td></td>
                                  <td>{{ cotizacion.prima_importacion|floatformat:2|intcomma }}</td>
                                {% else %}
                                  <td>No Incluido</td>
                                  <td></td>
                                  <td>-</td>
                                {% endif %}
                              </tr>
                              <tr>
                                <td>Acerta Preferencial Plus</td>
                                <td>Incluido</td>
                                <td></td>
                                <td>{{ cotizacion.prima_preferencialPlus|floatformat:2|intcomma }}</td>
                              </tr>
                            </table>
                            <h5 style="text-align: left;"><strong>Endoso:</strong> {{ cotizacion.endoso }}</h5>
                            {% bootstrap_form_errors form %}
                            <form action="" method="post" role="form" class="form-horizontal">
                            <div class="col-md-4"></div>
                            <div class="col-md-2">
                                <h5><br></h5>
                                <h5><br></h5>
                                <h5><br></h5>
                                <h5>{% bootstrap_field form.cuotas layout='horizontal' %}</h5>
                                <h5><br></h5>
                                <h5><br></h5>
                                <h5><br></h5>
                            </div>
                            <div class="col-md-3 text-right">
                              <h5>Subtotal:</h5>
                              <h5>Impuestos:</h5>
                              <h5><strong>Total a Pagar:</strong></h5>
                              <h5>Prima Mensual:</h5>
                              <h5>Prima Pago de Contado:</h5>
                              <h5>Prima Pago ACH/Visa:</h5>
                            </div>
                            <div class="col-md-3" style="text-align:left;">
                              <h5>B/.  {{ cotizacion.subtotal|floatformat:2|intcomma }}</h5>
                              <h5>B/.  {{ cotizacion.impuestos|floatformat:2|intcomma }}</h5>
                              <h5><strong>B/.  {{ cotizacion.total|floatformat:2|intcomma }}</strong></h5>
                              <h5 id="prima-mensual" data-total="{{ cotizacion.total|floatformat:2 }}">B/.  </h5>
                              <h5>B/.  {{ cotizacion.prima_pagoContado|floatformat:2|intcomma }}</h5>
                              <h5>B/.  {{ cotizacion.prima_pagoVisa|floatformat:2|intcomma }}</h5>
                            </div>
                            <br>
                        </div><!-- /.login-box-body -->
                    </div><!-- /.login-box -->
                </div>
            </div>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-md-2" style="padding-top: 1px; padding-bottom: 1%;">
    </div>
    <div class="col-md-4 text-center" style="padding-top: 1px; padding-bottom: 1%;">
        <button class="btn btn-lg back">
          <a id='opcion1' style="color:#ffffff;"href="{% url 'vehiculo'"><strong><  </strong> Volver
          </a>
      </button>
    </div>
    <div class="col-md-4 text-center" style="padding-top: 1px; padding-bottom: 1%;">
      {% csrf_token %}
      <button type="submit" class="btn select btn-lg" style="margin-left: 20px;">
        ENVIAR
      </button>
      <a class="btn select btn-lg" href="{% url 'vehiculo' %}">Nueva Cotización</a>
    </div>
    <div class="col-md-2" style="padding-top: 1px; padding-bottom: 10%;"></div>
</div>
{% endblock content %}

{% block custom_script %}

<script type="text/javascript">

  function addThousandsSeparator(input) {
      var output = input
      if (parseFloat(input)) {
          input = new String(input); // so you can perform string operations
          var parts = input.split("."); // remove the decimal part
          parts[0] = parts[0].split("").reverse().join("").replace(/(\d{3})(?!$)/g, "$1,").split("").reverse().join("");
          output = parts.join(".");
      }

      return output;
  }

  $(document).on("change", "#id_cuotas", function(){
      var cuotas = parseInt($(this).val());
      var total = parseInt($("#prima-mensual").data("total"));
      var mensualidad = total / cuotas;
      $("#prima-mensual").empty();
      $("#prima-mensual").append("B/.  " + addThousandsSeparator(mensualidad.toFixed(2).toString()));
  });

</script>

{% endblock custom_script %}
